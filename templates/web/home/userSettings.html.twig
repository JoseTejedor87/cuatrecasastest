{% extends 'web/base.html.twig' %}

{% block stylesheets %}
<link href="{{ asset('web/vendor/bootstrap-select/dist/css/bootstrap-select.min.css') }}" rel="stylesheet">
{% endblock %}

{% block main %}

    <main role="main">
        <article class="container">

            <header class="row page__header" style="background-image: url('{{ asset('web/assets/img/la-firma.jpg') }}')">
                <div class="col">
                    <div class="info__block">
                        <h1 class="page__title">
                            {{ 'userForm.title'|trans }}
                        </h1>
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item">
                                    <a href="{{ path('home') }}">{{ 'global.home'|trans }}</a>
                                </li>
                                <li class="breadcrumb-item active" aria-current="page">
                                    {{ 'userForm.title'|trans }}
                                </li>
                            </ol>
                        </nav>
                    </div>
                    <ul class="action__links">
                        <li><a href="#"><i class="material-icons">share</i></a></li>
                        <li><a href="#"><i class="material-icons">print</i></a></li>
                        <li><a href="#"><i class="material-icons">bookmark_border</i></a></li>
                    </ul>
                </div>
            </header>

            <form action="" id="userForm" class="needs-validation" novalidate>
                <div class="row page__block--full">
                    <div class="col">
                        <h4 class="section__title section__title--main">{{ 'userForm.settings.title'|trans }}</h4>
                        <fieldset>
                            <legend>{{ 'userForm.settings.subTitleInfo'|trans }}</legend>
                            <div class="row">
                                <div class="form-group col-lg-6">
                                    <input type="text" class="form-control" id="eFirstName" placeholder="Nombre *" required>
                                </div>
                                <div class="form-group col-lg-6">
                                    <input type="text" class="form-control" id="eLastName" placeholder="Apellidos *" required>
                                </div>
                                <div class="form-group col-lg-6">
                                    <input type="text" class="form-control" id="ePass" placeholder="Contraseña *" required>
                                </div>
                                <div class="form-group col-lg-6">
                                    <input type="text" class="form-control" id="eEmail" placeholder="Email *" required>
                                </div>
                            </div>
                        </fieldset>
                        <fieldset>
                            <legend>{{ 'userForm.settings.subTitleCompany'|trans }}</legend>
                            <div class="row">
                                <div class="form-group col-lg-6">
                                    <input type="text" class="form-control" id="ePosition" placeholder="Cargo *" required>
                                </div>
                                <div class="form-group col-lg-6">
                                    <input type="text" class="form-control" id="eCompany" placeholder="Empresa *" required>
                                </div>
                            </div>
                        </fieldset>
                        <fieldset>
                            <legend>{{ 'userForm.settings.subTitleContact'|trans }}</legend>
                            <div class="row">
                                <div class="col-lg-6 pr-0 pl-0">
                                    <div class="form-group col-lg-12">
                                        <input type="text" class="form-control" id="ePostalCode" placeholder="Código postal *" required>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <select name="eCountry" id="eCountry" class="selectpicker" data-style="btn-custom" data-width="100%" data-size="5" title="País *">
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                        </select>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <input type="text" class="form-control" id="eTown" placeholder="Población *" required>
                                    </div>
                                    <div class="form-group col-lg-12">
                                        <select name="eRegion" id="eRegion" class="selectpicker" data-style="btn-custom" data-width="100%" data-size="5" title="Provincia *" required>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <select name="eLang" id="eLang" class="selectpicker" data-style="btn-custom" data-width="100%" data-size="5" title="Idioma de las publicaciones *" required>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                            <option>Dolor</option>
                                            <option>Lorem</option>
                                            <option>Ipsum</option>
                                    </select>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                </div>

                <div class="row page__block--privacy">
                    <div class="col-12 privacy__text">
                        <h4 class="section__title section__title--main">{{ 'userForm.data.title'|trans }}</h4>
                        <p>Lorem, ipsum dolor, sit amet consectetur adipisicing elit. Natus, vitae eum ex, repellendus ullam,Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                        consequat.</p>
                        <p>Duis aute irure dolor in reprehenderit in voluptate velit esse
                        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                        proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                    </div>
                    <div class="col-12 privacy__confirm">
                        <div class="form-group">
                            <div class="checkbox">
                                <input type="checkbox" id="accept" required>
                                <label class="checkbox-label" for="accept"><span>He leído y acepto las <a href="#">Condiciones de Uso</a> y la <a href="#">Política de Privacidad</a></span></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="checkbox">
                                <input type="checkbox" id="subscribe">
                                <label class="checkbox-label" for="subscribe"><span>Deseo recibir información sobre novedades legales y eventos promovidos por Cuatrecasas, incluso por medios electrónicos</span></label>
                            </div>
                        </div>
                        <div class="button__wrapper">
                            <button type="submit" class="btn btn__solid btn__solid--icon" id="formSubmit">Guardar <span class="material-icons">save</span></button>
                        </div>
                    </div>
                </div>
            </form>

        </article>
    </main>

{% endblock %}

{% block javascripts %}
<script type="text/javascript" src="{{ asset('web/vendor/bootstrap-select/dist/js/bootstrap-select.min.js') }}"></script>
<script type="text/javascript" src="{{ asset('web/assets/js/responsiveTabs.js') }}"></script>
<script>
    $(function () {
        $('.classictabs__component .nav').responsiveTabs();

        // Bootstrap form validation
        'use strict';
        window.addEventListener('load', function() {
            var forms = document.getElementsByClassName('needs-validation');
            var validation = Array.prototype.filter.call(forms, function(form) {
                form.addEventListener('submit', function(event) {
                    if (form.checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();

                        var errorElements = document.querySelectorAll(".form-control.is-invalid");
                        $('html, body').animate({
                            scrollTop: $(errorElements[0]).offset().top - 120
                        }, 'slow');
                        $(errorElements[0]).focus();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        }, false);

        $("#formSubmit").click( function() {
            $("#userForm .form-control").removeClass('is-valid');
            $("#userForm .form-control").removeClass('is-invalid');
            var contacto =  validation();
            if(contacto){
                $.ajax({
                    method: "GET",
                    data: { contacto: JSON.stringify(contacto)  },
                    url: "{{ path('set_event_contact') }}",
                    beforeSend: function( xhr ) {
                    }
                    })
                .done(function( data ) {
                    console.log(data);
                })
                .fail(function() {
                });
            }
        });
        $("#eCountry").change( function() {
            var idCountry  =  $('#eCountry').val();
            var idCountry  =  $('#eCountry').val();
             $.ajax({
                    method: "GET",
                    data: { idCountry: idCountry  },
                    url: "{{ path('get_regions') }}",
                    beforeSend: function( xhr ) {
                    }
                    })
                .done(function( data ) {
                    var html = '';
                    data.forEach(function(region){
                        html = html + `<option value="`+region['IdProvincia']+`">`+region['Nombre']+`</option>`;
                    })
                    $('#eRegion').append( html  );
                })
                .fail(function() {
                });
        });

        function validation() {
            var contacto =  {};
            var isvalidate = true;
            if($("#eFirstName").val()){
                $("#eFirstName").addClass('is-valid');
                contacto['Nombre']= $("#eFirstName").val();
            }else{
                isvalidate = false;
                $("#eFirstName").addClass('is-invalid');
            }

            if($("#eLastName").val()){
                $("#eLastName").addClass('is-valid');
                contacto['Apellidos']= $("#eLastName").val();
            }else{
                $("#eLastName").addClass('is-invalid');
                isvalidate = false;
            }

            if($("#eEmail").val()){
                $("#eEmail").addClass('is-valid');
                contacto['Email']= $("#eEmail").val();
            }else{
                $("#eEmail").addClass('is-invalid');
                isvalidate = false;
            }

            if($("#ePosition").val()){
                $("#ePosition").addClass('is-valid');
                contacto['Cargo']= $("#ePosition").val();
            }else{
                $("#ePosition").addClass('is-invalid');
                isvalidate = false;
            }

            if($("#eCompany").val()){
                $("#eCompany").addClass('is-valid');
                contacto['Empresa']= $("#eCompany").val();
            }else{
                $("#eCompany").addClass('is-invalid');
                isvalidate = false;
            }

            if($("#eAddress").val()){
                $("#eAddress").addClass('is-valid');
                contacto['Direccion']= $("#eAddress").val();
            }else{
                $("#eAddress").addClass('is-invalid');
                isvalidate = false;
            }

            if($("#ePostalCode").val()){
                $("#ePostalCode").addClass('is-valid');
                contacto['CodigoPostal']= $("#ePostalCode").val();
            }else{
                $("#ePostalCode").addClass('is-invalid');
                isvalidate = false;
            }

            if($("#eCountry").val()){
                $("#eCountry").addClass('is-valid');
                contacto['IdPais']= $("#eCountry").val();
            }else{
                $("#eCountry").addClass('is-invalid');
                isvalidate = false;
            }

            if($("#eRegion").val()){
                $("#eRegion").addClass('is-valid');
                contacto['IdProvincia']= $("#eRegion").val();
            }else{
                $("#eRegion").addClass('is-invalid');
                isvalidate = false;
            }

            if($("#eTel").val()){
                $("#eTel").addClass('is-valid');
                contacto['Telefono']= $("#eTel").val();
            }else{
                $("#eTel").addClass('is-invalid');
                isvalidate = false;
            }

            if($("#accept").is(':checked')){
                contacto['GDPR']= 1;
            }else{
                isvalidate = false;
            }

            if($("#accept").is(':checked')){
                contacto['GDPR']= 1;
            }else{
                isvalidate = false;
            }
            if($("#subscribe").is(':checked')){
                contacto['Suscripcion']= 1;
            }else{
                contacto['Suscripcion']= 0;
            }

            if(isvalidate){
                return contacto;
            }else{
                return isvalidate;
            }
        }
    });
</script>
{% endblock %}
